ï
yC:\Users\carlo\Downloads\sexto\pruebas\segundaparcial\pruebav3\GestionCitasMedicas\GestionCitasMedicas\WeatherForecast.cs
	namespace 	
GestionCitasMedicas
 
{ 
public 

class 
WeatherForecast  
{ 
public 
DateOnly 
Date 
{ 
get "
;" #
set$ '
;' (
}) *
public 
int 
TemperatureC 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
int		 
TemperatureF		 
=>		  "
$num		# %
+		& '
(		( )
int		) ,
)		, -
(		- .
TemperatureC		. :
/		; <
$num		= C
)		C D
;		D E
public 
string 
? 
Summary 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
} ê
qC:\Users\carlo\Downloads\sexto\pruebas\segundaparcial\pruebav3\GestionCitasMedicas\GestionCitasMedicas\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder		 
.		 
Services		 
.		 
AddControllers		 
(		  
)		  !
;		! "
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
)  
;  !
builder 
. 
Services 
. 
AddDbContext 
< 
AppDBContext *
>* +
(+ ,
options, 3
=>4 6
options7 >
.> ?
UseSqlServer? K
(K L
builderL S
.S T
ConfigurationT a
.a b
GetConnectionStringb u
(u v
$str	v â
)
â ä
)
ä ã
)
ã å
;
å ç
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
if 
( 
app 
. 
Environment 
. 
IsDevelopment !
(! "
)" #
)# $
{ 
app 
. 

UseSwagger 
( 
) 
; 
app 
. 
UseSwaggerUI 
( 
) 
; 
} 
app 
. 
UseHttpsRedirection 
( 
) 
; 
app 
. 
UseAuthorization 
( 
) 
; 
app 
. 
MapControllers 
( 
) 
; 
app 
. 
Run 
( 
) 	
;	 
òZ
óC:\Users\carlo\Downloads\sexto\pruebas\segundaparcial\pruebav3\GestionCitasMedicas\GestionCitasMedicas\Migrations\20250121095752_InitialCitasMedicas.cs
	namespace 	
GestionCitasMedicas
 
. 

Migrations (
{ 
public		 

partial		 
class		 
InitialCitasMedicas		 ,
:		- .
	Migration		/ 8
{

 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str  
,  !
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 6
,6 7
nullable8 @
:@ A
falseB G
)G H
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
Nombre 
= 
table "
." #
Column# )
<) *
string* 0
>0 1
(1 2
type2 6
:6 7
$str8 G
,G H
nullableI Q
:Q R
trueS W
)W X
,X Y
Especialidad  
=! "
table# (
.( )
Column) /
</ 0
string0 6
>6 7
(7 8
type8 <
:< =
$str> M
,M N
nullableO W
:W X
trueY ]
)] ^
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 2
,2 3
x4 5
=>6 8
x9 :
.: ;
Id; =
)= >
;> ?
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str !
,! "
columns 
: 
table 
=> !
new" %
{ 
Id   
=   
table   
.   
Column   %
<  % &
int  & )
>  ) *
(  * +
type  + /
:  / 0
$str  1 6
,  6 7
nullable  8 @
:  @ A
false  B G
)  G H
.!! 

Annotation!! #
(!!# $
$str!!$ 8
,!!8 9
$str!!: @
)!!@ A
,!!A B
Nombre"" 
="" 
table"" "
.""" #
Column""# )
<"") *
string""* 0
>""0 1
(""1 2
type""2 6
:""6 7
$str""8 G
,""G H
nullable""I Q
:""Q R
true""S W
)""W X
,""X Y
Apellido## 
=## 
table## $
.##$ %
Column##% +
<##+ ,
string##, 2
>##2 3
(##3 4
type##4 8
:##8 9
$str##: I
,##I J
nullable##K S
:##S T
true##U Y
)##Y Z
,##Z [
FechaNacimiento$$ #
=$$$ %
table$$& +
.$$+ ,
Column$$, 2
<$$2 3
DateTime$$3 ;
>$$; <
($$< =
type$$= A
:$$A B
$str$$C N
,$$N O
nullable$$P X
:$$X Y
true$$Z ^
)$$^ _
}%% 
,%% 
constraints&& 
:&& 
table&& "
=>&&# %
{'' 
table(( 
.(( 

PrimaryKey(( $
((($ %
$str((% 3
,((3 4
x((5 6
=>((7 9
x((: ;
.((; <
Id((< >
)((> ?
;((? @
})) 
))) 
;)) 
migrationBuilder++ 
.++ 
CreateTable++ (
(++( )
name,, 
:,, 
$str,, 
,,, 
columns-- 
:-- 
table-- 
=>-- !
new--" %
{.. 
Id// 
=// 
table// 
.// 
Column// %
<//% &
int//& )
>//) *
(//* +
type//+ /
:/// 0
$str//1 6
,//6 7
nullable//8 @
://@ A
false//B G
)//G H
.00 

Annotation00 #
(00# $
$str00$ 8
,008 9
$str00: @
)00@ A
,00A B
Fecha11 
=11 
table11 !
.11! "
Column11" (
<11( )
DateTime11) 1
>111 2
(112 3
type113 7
:117 8
$str119 D
,11D E
nullable11F N
:11N O
true11P T
)11T U
,11U V
Descripcion22 
=22  !
table22" '
.22' (
Column22( .
<22. /
string22/ 5
>225 6
(226 7
type227 ;
:22; <
$str22= L
,22L M
nullable22N V
:22V W
true22X \
)22\ ]
,22] ^

PacienteId33 
=33  
table33! &
.33& '
Column33' -
<33- .
int33. 1
>331 2
(332 3
type333 7
:337 8
$str339 >
,33> ?
nullable33@ H
:33H I
true33J N
)33N O
,33O P
DoctorId44 
=44 
table44 $
.44$ %
Column44% +
<44+ ,
int44, /
>44/ 0
(440 1
type441 5
:445 6
$str447 <
,44< =
nullable44> F
:44F G
true44H L
)44L M
}55 
,55 
constraints66 
:66 
table66 "
=>66# %
{77 
table88 
.88 

PrimaryKey88 $
(88$ %
$str88% /
,88/ 0
x881 2
=>883 5
x886 7
.887 8
Id888 :
)88: ;
;88; <
table99 
.99 

ForeignKey99 $
(99$ %
name:: 
::: 
$str:: :
,::: ;
column;; 
:;; 
x;;  !
=>;;" $
x;;% &
.;;& '
DoctorId;;' /
,;;/ 0
principalTable<< &
:<<& '
$str<<( 2
,<<2 3
principalColumn== '
:==' (
$str==) -
)==- .
;==. /
table>> 
.>> 

ForeignKey>> $
(>>$ %
name?? 
:?? 
$str?? =
,??= >
column@@ 
:@@ 
x@@  !
=>@@" $
x@@% &
.@@& '

PacienteId@@' 1
,@@1 2
principalTableAA &
:AA& '
$strAA( 3
,AA3 4
principalColumnBB '
:BB' (
$strBB) -
)BB- .
;BB. /
}CC 
)CC 
;CC 
migrationBuilderEE 
.EE 
CreateTableEE (
(EE( )
nameFF 
:FF 
$strFF &
,FF& '
columnsGG 
:GG 
tableGG 
=>GG !
newGG" %
{HH 
IdII 
=II 
tableII 
.II 
ColumnII %
<II% &
intII& )
>II) *
(II* +
typeII+ /
:II/ 0
$strII1 6
,II6 7
nullableII8 @
:II@ A
falseIIB G
)IIG H
.JJ 

AnnotationJJ #
(JJ# $
$strJJ$ 8
,JJ8 9
$strJJ: @
)JJ@ A
,JJA B
DescripcionKK 
=KK  !
tableKK" '
.KK' (
ColumnKK( .
<KK. /
stringKK/ 5
>KK5 6
(KK6 7
typeKK7 ;
:KK; <
$strKK= L
,KKL M
nullableKKN V
:KKV W
trueKKX \
)KK\ ]
,KK] ^
CostoLL 
=LL 
tableLL !
.LL! "
ColumnLL" (
<LL( )
decimalLL) 0
>LL0 1
(LL1 2
typeLL2 6
:LL6 7
$strLL8 G
,LLG H
nullableLLI Q
:LLQ R
trueLLS W
)LLW X
,LLX Y
CitaIdMM 
=MM 
tableMM "
.MM" #
ColumnMM# )
<MM) *
intMM* -
>MM- .
(MM. /
typeMM/ 3
:MM3 4
$strMM5 :
,MM: ;
nullableMM< D
:MMD E
trueMMF J
)MMJ K
}NN 
,NN 
constraintsOO 
:OO 
tableOO "
=>OO# %
{PP 
tableQQ 
.QQ 

PrimaryKeyQQ $
(QQ$ %
$strQQ% 8
,QQ8 9
xQQ: ;
=>QQ< >
xQQ? @
.QQ@ A
IdQQA C
)QQC D
;QQD E
tableRR 
.RR 

ForeignKeyRR $
(RR$ %
nameSS 
:SS 
$strSS >
,SS> ?
columnTT 
:TT 
xTT  !
=>TT" $
xTT% &
.TT& '
CitaIdTT' -
,TT- .
principalTableUU &
:UU& '
$strUU( /
,UU/ 0
principalColumnVV '
:VV' (
$strVV) -
)VV- .
;VV. /
}WW 
)WW 
;WW 
migrationBuilderYY 
.YY 
CreateIndexYY (
(YY( )
nameZZ 
:ZZ 
$strZZ )
,ZZ) *
table[[ 
:[[ 
$str[[ 
,[[ 
column\\ 
:\\ 
$str\\ "
)\\" #
;\\# $
migrationBuilder^^ 
.^^ 
CreateIndex^^ (
(^^( )
name__ 
:__ 
$str__ +
,__+ ,
table`` 
:`` 
$str`` 
,`` 
columnaa 
:aa 
$straa $
)aa$ %
;aa% &
migrationBuildercc 
.cc 
CreateIndexcc (
(cc( )
namedd 
:dd 
$strdd 0
,dd0 1
tableee 
:ee 
$stree '
,ee' (
columnff 
:ff 
$strff  
)ff  !
;ff! "
}gg 	
	protectedjj 
overridejj 
voidjj 
Downjj  $
(jj$ %
MigrationBuilderjj% 5
migrationBuilderjj6 F
)jjF G
{kk 	
migrationBuilderll 
.ll 
	DropTablell &
(ll& '
namemm 
:mm 
$strmm &
)mm& '
;mm' (
migrationBuilderoo 
.oo 
	DropTableoo &
(oo& '
namepp 
:pp 
$strpp 
)pp 
;pp 
migrationBuilderrr 
.rr 
	DropTablerr &
(rr& '
namess 
:ss 
$strss  
)ss  !
;ss! "
migrationBuilderuu 
.uu 
	DropTableuu &
(uu& '
namevv 
:vv 
$strvv !
)vv! "
;vv" #
}ww 	
}xx 
}yy ”
èC:\Users\carlo\Downloads\sexto\pruebas\segundaparcial\pruebav3\GestionCitasMedicas\GestionCitasMedicas\Controllers\WeatherForecastController.cs
	namespace 	
GestionCitasMedicas
 
. 
Controllers )
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public 

class %
WeatherForecastController *
:+ ,
ControllerBase- ;
{ 
private		 
static		 
readonly		 
string		  &
[		& '
]		' (
	Summaries		) 2
=		3 4
new		5 8
[		8 9
]		9 :
{

 	
$str 
, 
$str !
,! "
$str# +
,+ ,
$str- 3
,3 4
$str5 ;
,; <
$str= C
,C D
$strE L
,L M
$strN S
,S T
$strU a
,a b
$strc n
} 	
;	 

[ 	
HttpGet	 
( 
Name 
= 
$str ,
), -
]- .
public 
IEnumerable 
< 
WeatherForecast *
>* +
Get, /
(/ 0
)0 1
{ 	
return 

Enumerable 
. 
Range #
(# $
$num$ %
,% &
$num' (
)( )
.) *
Select* 0
(0 1
index1 6
=>7 9
new: =
WeatherForecast> M
{ 
Date 
= 
DateOnly 
.  
FromDateTime  ,
(, -
DateTime- 5
.5 6
Now6 9
.9 :
AddDays: A
(A B
indexB G
)G H
)H I
,I J
TemperatureC 
= 
Random %
.% &
Shared& ,
., -
Next- 1
(1 2
-2 3
$num3 5
,5 6
$num7 9
)9 :
,: ;
Summary 
= 
	Summaries #
[# $
Random$ *
.* +
Shared+ 1
.1 2
Next2 6
(6 7
	Summaries7 @
.@ A
LengthA G
)G H
]H I
} 
) 
. 
ToArray 
( 
) 
; 
} 	
} 
} Ù;
éC:\Users\carlo\Downloads\sexto\pruebas\segundaparcial\pruebav3\GestionCitasMedicas\GestionCitasMedicas\Controllers\ProcedimientosController.cs
	namespace 	
GestionCitasMedicas
 
. 
Controllers )
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public		 

class		 $
ProcedimientosController		 )
:		* +
ControllerBase		, :
{

 
private 
readonly 
AppDBContext %

_dbContext& 0
;0 1
public $
ProcedimientosController '
(' (
AppDBContext( 4
	dbContext5 >
)> ?
{ 	

_dbContext 
= 
	dbContext "
;" #
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetProcedimientos) :
(: ;
); <
{ 	
return 
Ok 
( 
await 

_dbContext &
.& '
Procedimientos' 5
.5 6
Include6 =
(= >
p> ?
=>@ B
pC D
.D E
CitaE I
)I J
.J K
ToListAsyncK V
(V W
)W X
)X Y
;Y Z
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetProcedimiento) 9
(9 :
int: =
id> @
)@ A
{ 	
var 
procedimiento 
= 
await  %

_dbContext& 0
.0 1
Procedimientos1 ?
. 
Include 
( 
p 
=> 
p 
.  
Cita  $
)$ %
. 
FirstOrDefaultAsync $
($ %
p% &
=>' )
p* +
.+ ,
Id, .
==/ 1
id2 4
)4 5
;5 6
if 
( 
procedimiento 
==  
null! %
)% &
return' -
NotFound. 6
(6 7
$str7 S
)S T
;T U
return 
Ok 
( 
procedimiento #
)# $
;$ %
}   	
["" 	
HttpPost""	 
]"" 
public## 
async## 
Task## 
<## 
IActionResult## '
>##' (
CreateProcedimiento##) <
(##< =
Procedimiento##= J
procedimiento##K X
)##X Y
{$$ 	
var%% 
cita%% 
=%% 
await%% 

_dbContext%% '
.%%' (
Citas%%( -
.%%- .
	FindAsync%%. 7
(%%7 8
procedimiento%%8 E
.%%E F
CitaId%%F L
)%%L M
;%%M N
if&& 
(&& 
cita&& 
==&& 
null&& 
)&& 
return&& $

BadRequest&&% /
(&&/ 0
$str&&0 C
)&&C D
;&&D E
if(( 
((( 
procedimiento(( 
.(( 
Costo(( #
<(($ %
$num((& '
)((' (
return)) 

BadRequest)) !
())! "
$str))" B
)))B C
;))C D

_dbContext++ 
.++ 
Procedimientos++ %
.++% &
Add++& )
(++) *
procedimiento++* 7
)++7 8
;++8 9
await,, 

_dbContext,, 
.,, 
SaveChangesAsync,, -
(,,- .
),,. /
;,,/ 0
return-- 
Ok-- 
(-- 
procedimiento-- #
)--# $
;--$ %
}.. 	
[00 	
HttpPut00	 
]00 
public11 
async11 
Task11 
<11 
IActionResult11 '
>11' (
UpdateProcedimiento11) <
(11< =
Procedimiento11= J
procedimiento11K X
)11X Y
{22 	
var33 "
procedimientoExistente33 &
=33' (
await33) .

_dbContext33/ 9
.339 :
Procedimientos33: H
.44 
	FindAsync44 
(44 
procedimiento44 (
.44( )
Id44) +
)44+ ,
;44, -
if55 
(55 "
procedimientoExistente55 &
==55' )
null55* .
)55. /
return550 6
NotFound557 ?
(55? @
$str55@ Y
)55Y Z
;55Z [
var77 
cita77 
=77 
await77 

_dbContext77 '
.77' (
Citas77( -
.77- .
	FindAsync77. 7
(777 8
procedimiento778 E
.77E F
CitaId77F L
)77L M
;77M N
if88 
(88 
cita88 
==88 
null88 
)88 
return88 $

BadRequest88% /
(88/ 0
$str880 C
)88C D
;88D E
if:: 
(:: 
procedimiento:: 
.:: 
Costo:: #
<::$ %
$num::& '
)::' (
return;; 

BadRequest;; !
(;;! "
$str;;" B
);;B C
;;;C D"
procedimientoExistente== "
.==" #
Descripcion==# .
===/ 0
procedimiento==1 >
.==> ?
Descripcion==? J
;==J K"
procedimientoExistente>> "
.>>" #
Costo>># (
=>>) *
procedimiento>>+ 8
.>>8 9
Costo>>9 >
;>>> ?"
procedimientoExistente?? "
.??" #
CitaId??# )
=??* +
procedimiento??, 9
.??9 :
CitaId??: @
;??@ A
awaitAA 

_dbContextAA 
.AA 
SaveChangesAsyncAA -
(AA- .
)AA. /
;AA/ 0
returnBB 
OkBB 
(BB "
procedimientoExistenteBB ,
)BB, -
;BB- .
}CC 	
[EE 	

HttpDeleteEE	 
(EE 
$strEE 
)EE 
]EE 
publicFF 
asyncFF 
TaskFF 
<FF 
IActionResultFF '
>FF' (
DeleteProcedimientoFF) <
(FF< =
intFF= @
idFFA C
)FFC D
{GG 	
varHH 
procedimientoHH 
=HH 
awaitHH  %

_dbContextHH& 0
.HH0 1
ProcedimientosHH1 ?
.HH? @
	FindAsyncHH@ I
(HHI J
idHHJ L
)HHL M
;HHM N
ifII 
(II 
procedimientoII 
==II  
nullII! %
)II% &
returnII' -
NotFoundII. 6
(II6 7
$strII7 P
)IIP Q
;IIQ R

_dbContextKK 
.KK 
ProcedimientosKK %
.KK% &
RemoveKK& ,
(KK, -
procedimientoKK- :
)KK: ;
;KK; <
awaitLL 

_dbContextLL 
.LL 
SaveChangesAsyncLL -
(LL- .
)LL. /
;LL/ 0
returnMM 
OkMM 
(MM 
procedimientoMM #
)MM# $
;MM$ %
}NN 	
}OO 
}PP ≈6
âC:\Users\carlo\Downloads\sexto\pruebas\segundaparcial\pruebav3\GestionCitasMedicas\GestionCitasMedicas\Controllers\PacientesController.cs
	namespace 	
GestionCitasMedicas
 
. 
Controllers )
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public		 

class		 
PacientesController		 $
:		% &
ControllerBase		' 5
{

 
private 
readonly 
AppDBContext %

_dbContext& 0
;0 1
public 
PacientesController "
(" #
AppDBContext# /
	dbContext0 9
)9 :
{ 	

_dbContext 
= 
	dbContext "
;" #
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetPacientes) 5
(5 6
)6 7
{ 	
return 
Ok 
( 
await 

_dbContext &
.& '
	Pacientes' 0
.0 1
Include1 8
(8 9
p9 :
=>; =
p> ?
.? @
Citas@ E
)E F
.F G
ToListAsyncG R
(R S
)S T
)T U
;U V
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetPaciente) 4
(4 5
int5 8
id9 ;
); <
{ 	
var 
paciente 
= 
await  

_dbContext! +
.+ ,
	Pacientes, 5
.5 6
Include6 =
(= >
p> ?
=>@ B
pC D
.D E
CitasE J
)J K
. 
FirstOrDefaultAsync $
($ %
p% &
=>' )
p* +
.+ ,
Id, .
==/ 1
id2 4
)4 5
;5 6
if 
( 
paciente 
== 
null  
)  !
return" (
NotFound) 1
(1 2
$str2 I
)I J
;J K
return 
Ok 
( 
paciente 
) 
;  
} 	
[!! 	
HttpPost!!	 
]!! 
public"" 
async"" 
Task"" 
<"" 
IActionResult"" '
>""' (
CreatePaciente"") 7
(""7 8
Paciente""8 @
paciente""A I
)""I J
{## 	
if$$ 
($$ 
paciente$$ 
.$$ 
FechaNacimiento$$ (
>$$) *
DateTime$$+ 3
.$$3 4
Now$$4 7
)$$7 8
return%% 

BadRequest%% !
(%%! "
$str%%" _
)%%_ `
;%%` a

_dbContext&& 
.&& 
	Pacientes&&  
.&&  !
Add&&! $
(&&$ %
paciente&&% -
)&&- .
;&&. /
await'' 

_dbContext'' 
.'' 
SaveChangesAsync'' -
(''- .
)''. /
;''/ 0
return(( 
Ok(( 
((( 
paciente(( 
)(( 
;((  
})) 	
[++ 	
HttpPut++	 
]++ 
public,, 
async,, 
Task,, 
<,, 
IActionResult,, '
>,,' (
UpdatePaciente,,) 7
(,,7 8
Paciente,,8 @
paciente,,A I
),,I J
{-- 	
var.. 
pacienteExistente.. !
=.." #
await..$ )

_dbContext..* 4
...4 5
	Pacientes..5 >
...> ?
	FindAsync..? H
(..H I
paciente..I Q
...Q R
Id..R T
)..T U
;..U V
if// 
(// 
pacienteExistente// !
==//" $
null//% )
)//) *
return//+ 1
NotFound//2 :
(//: ;
$str//; O
)//O P
;//P Q
if11 
(11 
paciente11 
.11 
FechaNacimiento11 (
>11) *
DateTime11+ 3
.113 4
Now114 7
)117 8
return22 

BadRequest22 !
(22! "
$str22" N
)22N O
;22O P
pacienteExistente44 
.44 
Nombre44 $
=44% &
paciente44' /
.44/ 0
Nombre440 6
;446 7
pacienteExistente55 
.55 
Apellido55 &
=55' (
paciente55) 1
.551 2
Apellido552 :
;55: ;
await66 

_dbContext66 
.66 
SaveChangesAsync66 -
(66- .
)66. /
;66/ 0
return77 
Ok77 
(77 
pacienteExistente77 '
)77' (
;77( )
}88 	
[:: 	

HttpDelete::	 
(:: 
$str:: 
):: 
]:: 
public;; 
async;; 
Task;; 
<;; 
IActionResult;; '
>;;' (
DeletePaciente;;) 7
(;;7 8
int;;8 ;
id;;< >
);;> ?
{<< 	
var== 
paciente== 
=== 
await==  

_dbContext==! +
.==+ ,
	Pacientes==, 5
.==5 6
Include==6 =
(=== >
p==> ?
=>==@ B
p==C D
.==D E
Citas==E J
)==J K
.>> 
FirstOrDefaultAsync>> $
(>>$ %
p>>% &
=>>>' )
p>>* +
.>>+ ,
Id>>, .
==>>/ 1
id>>2 4
)>>4 5
;>>5 6
if?? 
(?? 
paciente?? 
==?? 
null??  
)??  !
return??" (
NotFound??) 1
(??1 2
$str??2 F
)??F G
;??G H
ifBB 
(BB 
pacienteBB 
.BB 
CitasBB 
.BB 
CountBB #
>BB$ %
$numBB& '
)BB' (
returnCC 

BadRequestCC !
(CC! "
$strCC" a
)CCa b
;CCb c

_dbContextFF 
.FF 
	PacientesFF  
.FF  !
RemoveFF! '
(FF' (
pacienteFF( 0
)FF0 1
;FF1 2
awaitGG 

_dbContextGG 
.GG 
SaveChangesAsyncGG -
(GG- .
)GG. /
;GG/ 0
returnHH 
OkHH 
(HH 
pacienteHH 
)HH 
;HH  
}II 	
}JJ 
}KK æ7
àC:\Users\carlo\Downloads\sexto\pruebas\segundaparcial\pruebav3\GestionCitasMedicas\GestionCitasMedicas\Controllers\DoctoresController.cs
	namespace 	
GestionCitasMedicas
 
. 
Controllers )
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public		 

class		 
DoctoresController		 #
:		$ %
ControllerBase		& 4
{

 
private 
readonly 
AppDBContext %

_dbContext& 0
;0 1
public 
DoctoresController !
(! "
AppDBContext" .
	dbContext/ 8
)8 9
{ 	

_dbContext 
= 
	dbContext "
;" #
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetDoctores) 4
(4 5
)5 6
{ 	
return 
Ok 
( 
await 

_dbContext &
.& '
Doctores' /
./ 0
Include0 7
(7 8
d8 9
=>: <
d= >
.> ?
Citas? D
)D E
.E F
ToListAsyncF Q
(Q R
)R S
)S T
;T U
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
	GetDoctor) 2
(2 3
int3 6
id7 9
)9 :
{ 	
var 
doctor 
= 
await 

_dbContext )
.) *
Doctores* 2
.2 3
Include3 :
(: ;
d; <
=>= ?
d@ A
.A B
CitasB G
)G H
. 
FirstOrDefaultAsync $
($ %
d% &
=>' )
d* +
.+ ,
Id, .
==/ 1
id2 4
)4 5
;5 6
if 
( 
doctor 
== 
null 
) 
return  &
NotFound' /
(/ 0
$str0 E
)E F
;F G
return 
Ok 
( 
doctor 
) 
; 
} 	
[!! 	
HttpPost!!	 
]!! 
public"" 
async"" 
Task"" 
<"" 
IActionResult"" '
>""' (
CreateDoctor"") 5
(""5 6
Doctor""6 <
doctor""= C
)""C D
{## 	
var%% 
doctorExistente%% #
=%%$ %
await%%& +

_dbContext%%, 6
.%%6 7
Doctores%%7 ?
.&& 
FirstOrDefaultAsync&& (
(&&( )
d&&) *
=>&&+ -
d&&. /
.&&/ 0
Nombre&&0 6
==&&7 9
doctor&&: @
.&&@ A
Nombre&&A G
&&&&H J
d&&K L
.&&L M
Especialidad&&M Y
==&&Z \
doctor&&] c
.&&c d
Especialidad&&d p
)&&p q
;&&q r
if'' 
('' 
doctorExistente'' 
!=''  "
null''# '
)''' (
return'') /

BadRequest''0 :
('': ;
$str''; s
)''s t
;''t u

_dbContext** 
.** 
Doctores** 
.**  
Add**  #
(**# $
doctor**$ *
)*** +
;**+ ,
await++ 

_dbContext++ 
.++ 
SaveChangesAsync++ -
(++- .
)++. /
;++/ 0
return,, 
Ok,, 
(,, 
doctor,, 
),, 
;,, 
}-- 	
[// 	
HttpPut//	 
]// 
public00 
async00 
Task00 
<00 
IActionResult00 '
>00' (
UpdateDoctor00) 5
(005 6
Doctor006 <
doctor00= C
)00C D
{11 	
var22 
doctorExistente22 
=22  !
await22" '

_dbContext22( 2
.222 3
Doctores223 ;
.22; <
	FindAsync22< E
(22E F
doctor22F L
.22L M
Id22M O
)22O P
;22P Q
if33 
(33 
doctorExistente33 
==33  "
null33# '
)33' (
return33) /
NotFound330 8
(338 9
$str339 K
)33K L
;33L M
doctorExistente55 
.55 
Nombre55 "
=55# $
doctor55% +
.55+ ,
Nombre55, 2
;552 3
doctorExistente66 
.66 
Especialidad66 (
=66) *
doctor66+ 1
.661 2
Especialidad662 >
;66> ?
await77 

_dbContext77 
.77 
SaveChangesAsync77 -
(77- .
)77. /
;77/ 0
return88 
Ok88 
(88 
doctorExistente88 %
)88% &
;88& '
}99 	
[;; 	

HttpDelete;;	 
(;; 
$str;; 
);; 
];; 
public<< 
async<< 
Task<< 
<<< 
IActionResult<< '
><<' (
DeleteDoctor<<) 5
(<<5 6
int<<6 9
id<<: <
)<<< =
{== 	
var>> 
doctor>> 
=>> 
await>> 

_dbContext>> )
.>>) *
Doctores>>* 2
.>>2 3
Include>>3 :
(>>: ;
d>>; <
=>>>= ?
d>>@ A
.>>A B
Citas>>B G
)>>G H
.?? 
FirstOrDefaultAsync?? $
(??$ %
d??% &
=>??' )
d??* +
.??+ ,
Id??, .
==??/ 1
id??2 4
)??4 5
;??5 6
if@@ 
(@@ 
doctor@@ 
==@@ 
null@@ 
)@@ 
return@@  &
NotFound@@' /
(@@/ 0
$str@@0 B
)@@B C
;@@C D
ifCC 
(CC 
doctorCC 
.CC 
CitasCC 
.CC 
CountCC !
>CC" #
$numCC$ %
)CC% &
returnDD 

BadRequestDD !
(DD! "
$strDD" _
)DD_ `
;DD` a

_dbContextFF 
.FF 
DoctoresFF 
.FF  
RemoveFF  &
(FF& '
doctorFF' -
)FF- .
;FF. /
awaitGG 

_dbContextGG 
.GG 
SaveChangesAsyncGG -
(GG- .
)GG. /
;GG/ 0
returnHH 
OkHH 
(HH 
doctorHH 
)HH 
;HH 
}II 	
}JJ 
}KK ùG
ÖC:\Users\carlo\Downloads\sexto\pruebas\segundaparcial\pruebav3\GestionCitasMedicas\GestionCitasMedicas\Controllers\CitasController.cs
	namespace 	
GestionCitasMedicas
 
. 
Controllers )
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public		 

class		 
CitasController		  
:		! "
ControllerBase		# 1
{

 
private 
readonly 
AppDBContext %

_dbContext& 0
;0 1
public 
CitasController 
( 
AppDBContext +
	dbContext, 5
)5 6
{ 	

_dbContext 
= 
	dbContext "
;" #
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetCitas) 1
(1 2
)2 3
{ 	
return 
Ok 
( 
await 

_dbContext &
.& '
Citas' ,
. 
Include 
( 
c 
=> 
c 
.  
Paciente  (
)( )
. 
Include 
( 
c 
=> 
c 
.  
Doctor  &
)& '
. 
Include 
( 
c 
=> 
c 
.  
Procedimientos  .
). /
. 
ToListAsync 
( 
) 
) 
;  
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetCita) 0
(0 1
int1 4
id5 7
)7 8
{ 	
var 
cita 
= 
await 

_dbContext '
.' (
Citas( -
.   
Include   
(   
c   
=>   
c   
.    
Paciente    (
)  ( )
.!! 
Include!! 
(!! 
c!! 
=>!! 
c!! 
.!!  
Doctor!!  &
)!!& '
."" 
Include"" 
("" 
c"" 
=>"" 
c"" 
.""  
Procedimientos""  .
)"". /
.## 
FirstOrDefaultAsync## $
(##$ %
c##% &
=>##' )
c##* +
.##+ ,
Id##, .
==##/ 1
id##2 4
)##4 5
;##5 6
if$$ 
($$ 
cita$$ 
==$$ 
null$$ 
)$$ 
return$$ $
NotFound$$% -
($$- .
$str$$. A
)$$A B
;$$B C
return%% 
Ok%% 
(%% 
cita%% 
)%% 
;%% 
}&& 	
[(( 	
HttpPost((	 
](( 
public)) 
async)) 
Task)) 
<)) 
IActionResult)) '
>))' (

CreateCita))) 3
())3 4
Cita))4 8
cita))9 =
)))= >
{** 	
var++ 
paciente++ 
=++ 
await++  

_dbContext++! +
.+++ ,
	Pacientes++, 5
.++5 6
	FindAsync++6 ?
(++? @
cita++@ D
.++D E

PacienteId++E O
)++O P
;++P Q
if,, 
(,, 
paciente,, 
==,, 
null,,  
),,  !
return,," (

BadRequest,,) 3
(,,3 4
$str,,4 K
),,K L
;,,L M
var.. 
doctor.. 
=.. 
await.. 

_dbContext.. )
...) *
Doctores..* 2
...2 3
	FindAsync..3 <
(..< =
cita..= A
...A B
DoctorId..B J
)..J K
;..K L
if// 
(// 
doctor// 
==// 
null// 
)// 
return//  &

BadRequest//' 1
(//1 2
$str//2 G
)//G H
;//H I

_dbContext11 
.11 
Citas11 
.11 
Add11  
(11  !
cita11! %
)11% &
;11& '
await22 

_dbContext22 
.22 
SaveChangesAsync22 -
(22- .
)22. /
;22/ 0
return33 
Ok33 
(33 
cita33 
)33 
;33 
}44 	
[66 	
HttpPut66	 
]66 
public77 
async77 
Task77 
<77 
IActionResult77 '
>77' (

UpdateCita77) 3
(773 4
Cita774 8
cita779 =
)77= >
{88 	
var99 
citaExistente99 
=99 
await99  %

_dbContext99& 0
.990 1
Citas991 6
.996 7
	FindAsync997 @
(99@ A
cita99A E
.99E F
Id99F H
)99H I
;99I J
if:: 
(:: 
citaExistente:: 
==::  
null::! %
)::% &
return::' -
NotFound::. 6
(::6 7
$str::7 G
)::G H
;::H I
var<< 
paciente<< 
=<< 
await<<  

_dbContext<<! +
.<<+ ,
	Pacientes<<, 5
.<<5 6
	FindAsync<<6 ?
(<<? @
cita<<@ D
.<<D E

PacienteId<<E O
)<<O P
;<<P Q
if== 
(== 
paciente== 
==== 
null==  
)==  !
return==" (

BadRequest==) 3
(==3 4
$str==4 K
)==K L
;==L M
var?? 
doctor?? 
=?? 
await?? 

_dbContext?? )
.??) *
Doctores??* 2
.??2 3
	FindAsync??3 <
(??< =
cita??= A
.??A B
DoctorId??B J
)??J K
;??K L
if@@ 
(@@ 
doctor@@ 
==@@ 
null@@ 
)@@ 
return@@  &

BadRequest@@' 1
(@@1 2
$str@@2 G
)@@G H
;@@H I
citaExistenteBB 
.BB 
FechaBB 
=BB  !
citaBB" &
.BB& '
FechaBB' ,
;BB, -
citaExistenteCC 
.CC 
DescripcionCC %
=CC& '
citaCC( ,
.CC, -
DescripcionCC- 8
;CC8 9
citaExistenteDD 
.DD 

PacienteIdDD $
=DD% &
citaDD' +
.DD+ ,

PacienteIdDD, 6
;DD6 7
citaExistenteEE 
.EE 
DoctorIdEE "
=EE# $
citaEE% )
.EE) *
DoctorIdEE* 2
;EE2 3
awaitGG 

_dbContextGG 
.GG 
SaveChangesAsyncGG -
(GG- .
)GG. /
;GG/ 0
returnHH 
OkHH 
(HH 
citaExistenteHH #
)HH# $
;HH$ %
}II 	
[KK 	

HttpDeleteKK	 
(KK 
$strKK 
)KK 
]KK 
publicLL 
asyncLL 
TaskLL 
<LL 
IActionResultLL '
>LL' (

DeleteCitaLL) 3
(LL3 4
intLL4 7
idLL8 :
)LL: ;
{MM 	
varNN 
citaNN 
=NN 
awaitNN 

_dbContextNN '
.NN' (
CitasNN( -
.OO 
IncludeOO 
(OO 
cOO 
=>OO 
cOO 
.OO  
ProcedimientosOO  .
)OO. /
.PP 
FirstOrDefaultAsyncPP $
(PP$ %
cPP% &
=>PP' )
cPP* +
.PP+ ,
IdPP, .
==PP/ 1
idPP2 4
)PP4 5
;PP5 6
ifQQ 
(QQ 
citaQQ 
==QQ 
nullQQ 
)QQ 
returnQQ $
NotFoundQQ% -
(QQ- .
$strQQ. >
)QQ> ?
;QQ? @
ifSS 
(SS 
citaSS 
.SS 
ProcedimientosSS #
.SS# $
CountSS$ )
>SS* +
$numSS, -
)SS- .
returnTT 

BadRequestTT !
(TT! "
$strTT" f
)TTf g
;TTg h

_dbContextWW 
.WW 
CitasWW 
.WW 
RemoveWW #
(WW# $
citaWW$ (
)WW( )
;WW) *
awaitXX 

_dbContextXX 
.XX 
SaveChangesAsyncXX -
(XX- .
)XX. /
;XX/ 0
returnYY 
OkYY 
(YY 
citaYY 
)YY 
;YY 
}ZZ 	
}[[ 
}\\ ¥6
vC:\Users\carlo\Downloads\sexto\pruebas\segundaparcial\pruebav3\GestionCitasMedicas\GestionCitasMedicas\AppDBContext.cs
	namespace 	
GestionCitasMedicas
 
{ 
public		 

class		 
AppDBContext		 
:		 
	DbContext		  )
{

 
public 
AppDBContext 
( 
DbContextOptions ,
<, -
AppDBContext- 9
>9 :
options; B
)B C
:D E
baseF J
(J K
optionsK R
)R S
{ 	
} 	
public 
DbSet 
< 
Paciente 
> 
	Pacientes (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
DbSet 
< 
Doctor 
> 
Doctores %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
DbSet 
< 
Cita 
> 
Citas  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DbSet 
< 
Procedimiento "
>" #
Procedimientos$ 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
} 
public 

class 
Paciente 
{ 
public 
required 
int 
Id 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
Nombre 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 
Apellido 
{  !
get" %
;% &
set' *
;* +
}, -
[ 	
Required	 
, 
JsonRequired 
]  
public 
DateTime 
? 
FechaNacimiento (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
[ 	

JsonIgnore	 
] 
public 
ICollection 
< 
Cita 
>  
Citas! &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
=5 6
new7 :
List; ?
<? @
Cita@ D
>D E
(E F
)F G
;G H
}   
public"" 

class"" 
Doctor"" 
{## 
public$$ 
required$$ 
int$$ 
Id$$ 
{$$  
get$$! $
;$$$ %
set$$& )
;$$) *
}$$+ ,
public%% 
string%% 
?%% 
Nombre%% 
{%% 
get%%  #
;%%# $
set%%% (
;%%( )
}%%* +
public&& 
string&& 
?&& 
Especialidad&& #
{&&$ %
get&&& )
;&&) *
set&&+ .
;&&. /
}&&0 1
[(( 	

JsonIgnore((	 
](( 
public)) 
ICollection)) 
<)) 
Cita)) 
>))  
Citas))! &
{))' (
get))) ,
;)), -
set)). 1
;))1 2
}))3 4
=))5 6
new))7 :
List)); ?
<))? @
Cita))@ D
>))D E
())E F
)))F G
;))G H
}** 
public,, 

class,, 
Cita,, 
{-- 
public.. 
required.. 
int.. 
Id.. 
{..  
get..! $
;..$ %
set..& )
;..) *
}..+ ,
[00 	
Required00	 
,00 
JsonRequired00 
]00  
public11 
DateTime11 
?11 
Fecha11 
{11  
get11! $
;11$ %
set11& )
;11) *
}11+ ,
public33 
string33 
?33 
Descripcion33 "
{33# $
get33% (
;33( )
set33* -
;33- .
}33/ 0
[55 	
Required55	 
,55 
JsonRequired55 
]55  
public66 
int66 
?66 

PacienteId66 
{66  
get66! $
;66$ %
set66& )
;66) *
}66+ ,
[88 	
Required88	 
,88 
JsonRequired88 
]88  
public99 
int99 
?99 
DoctorId99 
{99 
get99 "
;99" #
set99$ '
;99' (
}99) *
[;; 	

JsonIgnore;;	 
];; 
public<< 
Paciente<< 
?<< 
Paciente<< !
{<<" #
get<<$ '
;<<' (
set<<) ,
;<<, -
}<<. /
[>> 	

JsonIgnore>>	 
]>> 
public?? 
Doctor?? 
??? 
Doctor?? 
{?? 
get??  #
;??# $
set??% (
;??( )
}??* +
publicAA 
ICollectionAA 
<AA 
ProcedimientoAA (
>AA( )
ProcedimientosAA* 8
{AA9 :
getAA; >
;AA> ?
setAA@ C
;AAC D
}AAE F
=AAG H
newAAI L
ListAAM Q
<AAQ R
ProcedimientoAAR _
>AA_ `
(AA` a
)AAa b
;AAb c
}BB 
publicDD 

classDD 
ProcedimientoDD 
{EE 
publicFF 
requiredFF 
intFF 
IdFF 
{FF  
getFF! $
;FF$ %
setFF& )
;FF) *
}FF+ ,
publicGG 
stringGG 
?GG 
DescripcionGG "
{GG# $
getGG% (
;GG( )
setGG* -
;GG- .
}GG/ 0
[II 	
RequiredII	 
,II 
JsonRequiredII 
]II  
publicJJ 
decimalJJ 
?JJ 
CostoJJ 
{JJ 
getJJ  #
;JJ# $
setJJ% (
;JJ( )
}JJ* +
[LL 	
RequiredLL	 
,LL 
JsonRequiredLL 
]LL  
publicMM 
intMM 
?MM 
CitaIdMM 
{MM 
getMM  
;MM  !
setMM" %
;MM% &
}MM' (
[OO 	

JsonIgnoreOO	 
]OO 
publicPP 
CitaPP 
?PP 
CitaPP 
{PP 
getPP 
;PP  
setPP! $
;PP$ %
}PP& '
}QQ 
}SS 